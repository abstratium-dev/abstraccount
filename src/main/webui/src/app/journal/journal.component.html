<div class="journal-container">
  <h1>Journal Viewer</h1>

  <!-- Error Display -->
  <div *ngIf="error" class="error-message">
    {{ error }}
  </div>

  <!-- Loading Indicator -->
  <div *ngIf="loading" class="loading">
    Loading...
  </div>

  <!-- Account Selection -->
  <div class="account-selection">
    <label for="account-select">Select Account:</label>
    <select 
      id="account-select" 
      [(ngModel)]="selectedAccount" 
      (change)="onAccountSelected()"
      class="form-control">
      <option [value]="null">-- Select an account --</option>
      <option *ngFor="let account of accounts" [value]="account.accountName">
        {{ account.accountName }} ({{ account.accountType }})
      </option>
    </select>
  </div>

  <!-- Balance Display -->
  <div *ngIf="balance" class="balance-display">
    <h3>Current Balance: {{ getBalanceString() }}</h3>
  </div>

  <!-- Filters -->
  <div *ngIf="selectedAccount" class="filters">
    <h3>Filters</h3>
    <div class="filter-row">
      <div class="filter-field">
        <label for="start-date">Start Date:</label>
        <input 
          type="date" 
          id="start-date" 
          [(ngModel)]="startDate" 
          class="form-control">
      </div>
      
      <div class="filter-field">
        <label for="end-date">End Date:</label>
        <input 
          type="date" 
          id="end-date" 
          [(ngModel)]="endDate" 
          class="form-control">
      </div>
      
      <div class="filter-field">
        <label for="status">Status:</label>
        <select id="status" [(ngModel)]="status" class="form-control">
          <option value="">All</option>
          <option value="CLEARED">Cleared</option>
          <option value="PENDING">Pending</option>
          <option value="UNCLEARED">Uncleared</option>
        </select>
      </div>
      
      <div class="filter-buttons">
        <button (click)="applyFilters()" class="btn btn-primary">Apply Filters</button>
        <button (click)="clearFilters()" class="btn btn-secondary">Clear</button>
      </div>
    </div>
  </div>

  <!-- Postings Table -->
  <div *ngIf="selectedAccount && postings.length > 0" class="postings-table">
    <h3>Postings</h3>
    <table class="table">
      <thead>
        <tr>
          <th>Date</th>
          <th>Status</th>
          <th>Description</th>
          <th>Commodity</th>
          <th class="amount">Amount</th>
          <th class="amount">Running Balance</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let posting of postings" 
            [class.positive]="posting.amount > 0"
            [class.negative]="posting.amount < 0">
          <td>{{ formatDate(posting.transactionDate) }}</td>
          <td>
            <span class="status-badge" [class]="posting.transactionStatus.toLowerCase()">
              {{ posting.transactionStatus }}
            </span>
          </td>
          <td>{{ posting.transactionDescription }}</td>
          <td>{{ posting.commodity }}</td>
          <td class="amount">{{ formatAmount(posting.amount) }}</td>
          <td class="amount">
            <strong>{{ posting.runningBalance ? formatAmount(posting.runningBalance) : '-' }}</strong>
          </td>
        </tr>
      </tbody>
    </table>
    
    <div class="posting-count">
      Total postings: {{ postings.length }}
    </div>
  </div>

  <!-- No Data Message -->
  <div *ngIf="selectedAccount && postings.length === 0 && !loading" class="no-data">
    No postings found for the selected account and filters.
  </div>

  <!-- No Account Selected -->
  <div *ngIf="!selectedAccount && !loading" class="no-selection">
    Please select an account to view its postings.
  </div>
</div>
